<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="quanke, java" />





  <link rel="alternate" href="/atom.xml" title="全科-不安分的码农" type="application/atom+xml" />






<meta property="og:type" content="website">
<meta property="og:title" content="全科-不安分的码农">
<meta property="og:url" content="http://quanke.name/page/7/index.html">
<meta property="og:site_name" content="全科-不安分的码农">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="全科-不安分的码农">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://quanke.name/page/7/"/>





  <title>全科-不安分的码农</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?853906ed403c461b2dbf1df696bdf998";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">全科-不安分的码农</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">android，ios，html5，微服务架构，XP，scrum，项目管理（PMP）</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://quanke.name/2012/11/15/android/android-e7-95-8c-e9-9d-a2-e9-80-82-e9-85-8d-e5-a4-84-e7-90-86-e8-ae-b0-e5-bd-95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="全科">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/dog.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="全科-不安分的码农">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2012/11/15/android/android-e7-95-8c-e9-9d-a2-e9-80-82-e9-85-8d-e5-a4-84-e7-90-86-e8-ae-b0-e5-bd-95/" itemprop="url">android 界面适配处理记录</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2012-11-15T05:41:16+08:00">
                2012-11-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/android开发/" itemprop="url" rel="index">
                    <span itemprop="name">android开发</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2012/11/15/android/android-e7-95-8c-e9-9d-a2-e9-80-82-e9-85-8d-e5-a4-84-e7-90-86-e8-ae-b0-e5-bd-95/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2012/11/15/android/android-e7-95-8c-e9-9d-a2-e9-80-82-e9-85-8d-e5-a4-84-e7-90-86-e8-ae-b0-e5-bd-95/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>android 界面琐碎，各种分辨率，各种destiny 当然,按照官方的处理方法，图片可以分别准备几套分辨率不同的图片放几个drawable 文件夹下，而不同的界面布局也可以写几套xml 分别放于不同的llayout 文件夹下，当图片比较多时，达到几兆或者更大，上面的处理方法会让apk变得很大，显的很冗余。<br>写xml文件时，我们一般采用相对分辨率dip ，dip与像素之间的转化公式不知道的大家可以查下，这里就不说了<br>px = dip*destiny/160</p>
<p>destiny 是每英寸的像素点数<br>这几个参数可以手动计算，也可以通过程序获得，虽然目前几种获取屏幕参数的方法在几种设备上，各种山寨非山寨得出的准确性有待考究。<br>在淘宝的热卖手机中取了几个参数，目前市面常见的手机或者说销量高的手机， 按照上面的公式把像素转化为dip ，由于一般的手机的分辨率 长宽比还是比较接近的，所以测出虽然手机的destiny从210到300不等（题外话：其实300已经接近或超出人眼能识别的极限了）但算出来 x轴即横线dip一般大于320 位于320 到370 之间，纵向640左右，，所以写xml时可以把处理的面积设成 320 *620 左右，再适当的调整 ，而对于图片较多，其实可以选相对适中的分辨率 图片，然后涉及到图片的控件吧相应属性设置如下<br>android:layout_width=”20dip”<br>android:layout_height=”20dip”<br>android:scaleType=”fitCenter”<br>后面的数值可调，看你想要的大小， 这样图片会自动居中填满你指定的区域，一般手机是没问题（其实也就随便找了3部手机测了测）。对于实在前面算出的横向和纵向分辨率大的 ，可以在java层一开始读取xml文件之前判断一下 读取不同的xml文件，至于图片要求不是特别高清的，上面的处理其实程序自动伸缩的  效果就可以了，当然 你可以测试下。当然有特别要求的图片 可以相应的放不同的文件夹（没测过），这样，至少减少图片的数量 xml文件的数量 处理起来比较简单，当然pad没做相应调查，目前也值做了手机的适配。<br>只是今天突然有点忘记，记录一下，不知道的了解下，知道的 一笑而过就好了</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://quanke.name/2012/11/15/android/android-e5-b1-8f-e5-b9-95-e9-80-82-e9-85-8d-e9-97-ae-e9-a2-98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="全科">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/dog.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="全科-不安分的码农">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2012/11/15/android/android-e5-b1-8f-e5-b9-95-e9-80-82-e9-85-8d-e9-97-ae-e9-a2-98/" itemprop="url">android 屏幕适配问题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2012-11-15T05:29:23+08:00">
                2012-11-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/android开发/" itemprop="url" rel="index">
                    <span itemprop="name">android开发</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2012/11/15/android/android-e5-b1-8f-e5-b9-95-e9-80-82-e9-85-8d-e9-97-ae-e9-a2-98/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2012/11/15/android/android-e5-b1-8f-e5-b9-95-e9-80-82-e9-85-8d-e9-97-ae-e9-a2-98/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>如何将一个应用程序适配在不同的手机上，虽然这不算是一个技术问题，但是对于刚刚做屏幕的开发人员来说，还真不是一件多么简单的事情。</p>
<p>首先：你需要在AndroidManifest.xml文件的<manifest>元素如下添加子元素<br>[code lang=”xml”]<br>&lt;supports-screens android:largeScreens=&quot;true&quot;<br>       android:normalScreens=&quot;true&quot; android:anyDensity=&quot;true&quot;<br>       android:smallScreens=&quot;true&quot;&gt;<br>&lt;/supports-screens&gt;<br>[/code]</manifest></p>
<pre><code>名如其意，以上是为我们的屏幕设置多分辨率支持（更准确的说是适配大、中、小三种密度）。android:anyDensity=&quot;true&quot; ，这一句对整个的屏幕都起着十分重要的作用，值为true，我们的应用程序当安装在不同密度的手机上时，程序会分别加载hdpi,mdpi,ldpi文件夹中的资源。
</code></pre><p>相反，如果值设置为false，即使我们在hdpi,mdpi,ldpi文件夹下拥有同一种资源，那么应用也不会自动地去相应文件夹下寻找资源，这种情况都是出现在高密度，以及低密度的手机上，比如说一部240×320像素的手机，如果设置android:anyDensity=”false”，Android系统会将240 x 320(低密度)转换为 320×480(中密度)，这样的话，应用就会在小密度手机上加载mdpi文件中的资源。</p>
<p>2.细心的人会发现自android2.0开始之后drawable文件被三个文件夹drawable-hdpi,drawable-mdpi,drawable-ldpi三个文件夹所取代，有些编程人员为了让应用程序默认地加载某些图片，他们会特意地去在android2.0之后的应用程序中重新创建drawable文件夹，其实这样做完全没有必要，通过第一段的分析我们得知，android:anyDensity=”false”，则应用会将大小密度转变成中密度，从而去加载mdpi中的资源。这里同样，当android:anyDensity=”false”，则应用会去加载mdpi中的资源。</p>
<p>总结一下：</p>
<p>第一：android:anyDensity=”true”，系统会依据屏幕密度，自动去找对应的文件夹</p>
<p>第二：android:anyDensity=”false”,</p>
<p>(1)              如果drawable-hdpi,drawable-mdpi,drawable-ldpi三个文件夹中有同一张图片资源的不同密度表示，那么系统会去加载drawable_mdpi文件夹中的资源</p>
<p>(2)              如果drawable-hpdi中有高密度图片，其它两个文件夹中没有对应图片资源，那么系统会去加载drawable-hdpi中的资源。</p>
<p>(3)              如果drawable-hdpi,drawable-mdpi中有图片资源，drawable-ldpi中没有对应的图片资源，那么系统会加载drawable-mdpi文件夹中的资源</p>
<p>3. 注意上图各种文件夹的不同表示。</p>
<p>drawable-hdpi 该图片即适用于横屏，也适用于竖屏</p>
<p>drawable-land-hdpi,当屏幕为横屏，且为高密度时，加载此文件夹中的资源</p>
<p>drawable-port-hdpi,当屏幕为竖屏，且为高密度时，加载此文件夹中的资源</p>
<p>3. 有时候会根据需要在代码中动态地设置某个值，比如地图，地图的pin和地图的地址提示框的相对偏移量在不同密度的手机上是不同的。这时候可以通过以下方法求出屏幕密度：</p>
<p>[code lang=”java”]<br>DisplayMetrics metric = new DisplayMetrics();<br>getWindowManager().getDefaultDisplay().getMetrics(metric);</p>
<p>int densityDpi = metric.densityDpi;  // 屏幕密度DPI（120 / 160 / 240）</p>
<p>[/code]</p>
<p>然后可以在代码中为这几种密度分别设置便宜量</p>
<p>但是这种方法最好不要使用，最好的方式是在xml文件中不同密度的手机进行分别设置。</p>
<p>这里地图的偏移量可以在values-hpdi,values-mdpi,values-ldpi三种文件夹中的dimens.xml文件进行设置</p>
<p>值得一提的是：</p>
<pre><code>&lt;dimen name=&quot;bitmap_common_topoffset&quot;&gt;40dp&lt;/dimen&gt;

&lt;dimen name=&quot;bitmap_common_bottomoffset&quot;&gt;-14dp&lt;/dimen&gt;
</code></pre><p>这里的负数是完全起作用的，系统会认为它是一个负值</p>
<p>4. 各大手机厂商对于Android操作系统都有或多或少的改动，当然这些改动会对我们应用程序产生某些影响</p>
<p>  比如：</p>
<p>   （1）系统源代码中连接music服务的aidl文件所在包名：com.android.music </p>
<p>   （2）LG则可能将该aidl文件修改所在的包（例如修改为 com.android.music.player），并且修改其中的文件内容（增加一个方法，或者减少几个方法，或者修改方法名称）那么我们的应用要想在LG的手机上发布，那么我们就必须改变所要连接的aidl文件,必须跟LG厂商修改的完全一致。</p>
<p>5. 国际化问题.</p>
<p>   有时候在xml中设置了相应的语言，但是为什么当我们更改语言之后，UI显示仍然不起作用？</p>
<p>   不要怀疑是系统出了问题，这与我们在代码中引用values/string.xml中字符串的方式有关。</p>
<p>   错误的方式：</p>
<p>   1. 声明全局变量 private static String tempStr;</p>
<p>   2. 在onCreate方法中对该变量赋值 tempStr = context.getString(R.string.test);</p>
<p>   3. 在更新UI的方法（非onCreate方法）中引用该变量。 textView.setText(tempStr);</p>
<p>   原因是由于，当修改本地语言时，onCreate不会再被执行一遍. 变量tempStr 依然会使用页面刚启动时加载的默认英语。</p>
<p>   正确的方式：</p>
<p>   直接进行第三步：textView.setText(context.getString(R.string.test));</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://quanke.name/2012/11/13/ahk--autohotkey/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="全科">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/dog.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="全科-不安分的码农">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2012/11/13/ahk--autohotkey/" itemprop="url">AHK 懒人包 – AutoHotKey 汉化版 + 教程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2012-11-13T09:48:50+08:00">
                2012-11-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/随笔/" itemprop="url" rel="index">
                    <span itemprop="name">随笔</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2012/11/13/ahk--autohotkey/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2012/11/13/ahk--autohotkey/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>标题已经告诉你大部分了。我要告诉大家的是，<a href="http://www.appinn.com/" target="_blank" rel="external">小众软件</a>出品的 <a href="http://www.appinn.com/tagAutoHotKey" target="_blank" rel="external">AHK</a> 懒人包中有什么好东西。哈哈。</p>
<ol>
<li>打包了连载于小众软件和<a href="http://jandan.net/" target="_blank" rel="external">煎蛋</a>的全部 AHK 快餐店教程。</li>
<li>快餐店教程的全部脚本，在文中脚本这个文件夹里。</li>
<li><a href="http://ahk.5d6d.com/thread-183-1-1.html" target="_blank" rel="external">AutoHotKey 汉化版</a> 由 <a href="http://0527.yo2.cn/" target="_blank" rel="external">BLooM2</a> 制作。我从官方下载了最新的 <a href="http://www.autohotkey.com/" target="_blank" rel="external">AutoHotKey</a> 整合在 AutoHotKey 中文版的文件夹里。</li>
<li>还附上了 <a href="http://ahk.5d6d.com/bbs.php" target="_blank" rel="external">ahk 中文论坛</a>翻译的 AutoHotKey 帮助文件，<a href="http://www.appinn.com/ahk.5d6d.com/thread-3313-1-1.html" target="_blank" rel="external">AutoHotkey 1.0.48.05准中文版(已增加搜索和书签功能)</a><br><img src="http://www.appinn.com/wp-content/down.gif" alt="AHK 懒人包   AutoHotKey 汉化版 + 教程[图] | 小众软件" title="点击右侧的链接下载本软件"> 下载(3.4 MB): <a href="http://g.appinn.com/qs" target="_blank" rel="external">Go Everbox</a> | <a href="http://downdao.com/appinn/119446" target="_blank" rel="external">Downdao</a> | <a href="http://pan.baidu.com/share/link?shareid=75383&amp;uk=4010168515" target="_blank" rel="external">baidu</a> | <a href="http://www.autohotkey.com/" target="_blank" rel="external">官方网站</a> | <a href="http://www.appinn.com/AutoHotKey-%E6%87%92%E4%BA%BA%E5%8C%85/" target="_blank" rel="external">来自小众软件</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://quanke.name/2012/11/12/android/android-e4-b9-8bexpandablelistview-e5-87-a0-e4-b8-aa-e7-89-b9-e6-ae-8a-e7-9a-84-e5-b1-9e-e6-80-a7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="全科">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/dog.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="全科-不安分的码农">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2012/11/12/android/android-e4-b9-8bexpandablelistview-e5-87-a0-e4-b8-aa-e7-89-b9-e6-ae-8a-e7-9a-84-e5-b1-9e-e6-80-a7/" itemprop="url">Android 之ExpandableListView几个特殊的属性</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2012-11-12T10:17:22+08:00">
                2012-11-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/android开发/" itemprop="url" rel="index">
                    <span itemprop="name">android开发</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2012/11/12/android/android-e4-b9-8bexpandablelistview-e5-87-a0-e4-b8-aa-e7-89-b9-e6-ae-8a-e7-9a-84-e5-b1-9e-e6-80-a7/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2012/11/12/android/android-e4-b9-8bexpandablelistview-e5-87-a0-e4-b8-aa-e7-89-b9-e6-ae-8a-e7-9a-84-e5-b1-9e-e6-80-a7/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>1. 设置ExpandableListView 默认是展开的:<br>先实例化 exListView<br>然后<br>   exListView.setAdapter(exlvAdapter);<br>   //遍历所有group,将所有项设置成默认展开<br>   int groupCount = exListView.getCount();<br>   for (int i=0; i&lt;groupCount; i++) {<br>       exListView.expandGroup(i);<br>       };</p>
<p>2. 去掉ExpandableListView 默认的箭头<br>  用到ExpandableListView时有个箭头图标系统自带的在你自定义布局也不能去掉只要设置一个属性即可，如下：<br>  settingLists.setGroupIndicator(null);  <del>~</del><del>~</del><del>~</del>~~此处就是设置自定义的箭头图标的。置空则没有了。</p>
<p>也可以自定义（但是位置还是在那个地方不推荐）如下：<br>首先，自定义一个expandablelistviewselector.xml文件，具体内容如下：<br>Java代码<br>&lt;?xml version=”1.0” encoding=”utf-8”?&gt;   </p>
<p><selector xmlns:android="http://schemas.android.com/apk/res/android"><br>    <item android:state_expanded="true" android:drawable="@drawable/expandablelistviewindicatordown"><br>    <item android:drawable="@drawable/expandablelistviewindicator"><br></item></item></selector><br>加一句代码如下：<br>settingLists.setGroupIndicator(this.getResources().getDrawable(R.layout.expandablelistviewselector));<br>大功告成<br>3. 将默认的箭头修改到右边显示:</p>
<p>1首先 ExpandableListView elistview;<br>         elistview.setGroupIndicator(null);//将控件默认的左边箭头去掉，<br>2在 自定义的继承自BaseExpandableListAdapter的adapter中有一个方法<br>/**</p>
<ul>
<li><p>父类view<br>*/<br> @Override<br> public View getGroupView(int groupPosition, boolean isExpanded,</p>
<pre><code>    View convertView, ViewGroup parent) {
Log.i(&quot;zhaoxiong&quot;,&quot;parent view&quot;);
    LinearLayout parentLayout=(LinearLayout) View.inflate(context, R.layout.wowocoupons_parent_item, null);
    TextView parentTextView=(TextView) parentLayout.findViewById(R.id.parentitem);
    parentTextView.setText(parentlist.get(groupPosition));
    ImageView parentImageViw=(ImageView) parentLayout.findViewById(R.id.arrow);
</code></pre><p>//判断isExpanded就可以控制是按下还是关闭，同时更换图片</p>
<pre><code>    if(isExpanded){
        parentImageViw.setBackgroundResource(R.drawable.arrow_down);
    }else{
        parentImageViw.setBackgroundResource(R.drawable.arrow_up);
    }

return parentLayout;
</code></pre><p> }</p>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://quanke.name/2012/11/12/android/android-edittext-e5-be-97-e5-88-b0-e5-92-8c-e5-a4-b1-e5-8e-bb-e7-84-a6-e7-82-b9-e6-97-b6-ef-bc-8c-e8-87-aa-e5-ae-9a-e4-b9-89-e5-a4-84-e7-90-86-e5-86-85-e5-ae-b9/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="全科">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/dog.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="全科-不安分的码农">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2012/11/12/android/android-edittext-e5-be-97-e5-88-b0-e5-92-8c-e5-a4-b1-e5-8e-bb-e7-84-a6-e7-82-b9-e6-97-b6-ef-bc-8c-e8-87-aa-e5-ae-9a-e4-b9-89-e5-a4-84-e7-90-86-e5-86-85-e5-ae-b9/" itemprop="url">Android EditText得到和失去焦点时，自定义处理内容</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2012-11-12T10:00:34+08:00">
                2012-11-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/android开发/" itemprop="url" rel="index">
                    <span itemprop="name">android开发</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2012/11/12/android/android-edittext-e5-be-97-e5-88-b0-e5-92-8c-e5-a4-b1-e5-8e-bb-e7-84-a6-e7-82-b9-e6-97-b6-ef-bc-8c-e8-87-aa-e5-ae-9a-e4-b9-89-e5-a4-84-e7-90-86-e5-86-85-e5-ae-b9/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2012/11/12/android/android-edittext-e5-be-97-e5-88-b0-e5-92-8c-e5-a4-b1-e5-8e-bb-e7-84-a6-e7-82-b9-e6-97-b6-ef-bc-8c-e8-87-aa-e5-ae-9a-e4-b9-89-e5-a4-84-e7-90-86-e5-86-85-e5-ae-b9/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>当android的Edittext得到/失去焦点时，需要自定义一些处理内容时，需要对EditText对象的Focus进行监听处理。<br>在Activity中，做以下处理：<br>1.取得EditText对象。<br>2.为取得的对象添加setOnFocusChangeListener()，重写里面的方法。<br>如下：<br>[code lang=”java”]<br>EditText loginPwd = (EditText) findViewById(R.id.editText);<br>editText.setOnFocusChangeListener(new android.view.View.OnFocusChangeListener() {<br>    @Override<br>    public void onFocusChange(View v, boolean hasFocus) {<br>        if(hasFocus) {<br>// 此处为得到焦点时的处理内容<br>} else {<br>// 此处为失去焦点时的处理内容<br>}<br>    }<br>});<br>[/code] </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://quanke.name/2012/11/12/e5-a6-82-e4-bd-95-e8-ae-a9edittext-e5-9c-a8activity-e8-b5-b7-e5-a7-8b-e7-9a-84-e6-97-b6-e5-80-99-e4-b8-8d-e8-87-aa-e5-8a-a8-e8-8e-b7-e5-be-97-e7-84-a6-e7-82-b9-ef-bc-9f/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="全科">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/dog.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="全科-不安分的码农">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2012/11/12/e5-a6-82-e4-bd-95-e8-ae-a9edittext-e5-9c-a8activity-e8-b5-b7-e5-a7-8b-e7-9a-84-e6-97-b6-e5-80-99-e4-b8-8d-e8-87-aa-e5-8a-a8-e8-8e-b7-e5-be-97-e7-84-a6-e7-82-b9-ef-bc-9f/" itemprop="url">如何让edittext在activity起始的时候不自动获得焦点？</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2012-11-12T07:57:30+08:00">
                2012-11-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/android开发/" itemprop="url" rel="index">
                    <span itemprop="name">android开发</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2012/11/12/e5-a6-82-e4-bd-95-e8-ae-a9edittext-e5-9c-a8activity-e8-b5-b7-e5-a7-8b-e7-9a-84-e6-97-b6-e5-80-99-e4-b8-8d-e8-87-aa-e5-8a-a8-e8-8e-b7-e5-be-97-e7-84-a6-e7-82-b9-ef-bc-9f/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2012/11/12/e5-a6-82-e4-bd-95-e8-ae-a9edittext-e5-9c-a8activity-e8-b5-b7-e5-a7-8b-e7-9a-84-e6-97-b6-e5-80-99-e4-b8-8d-e8-87-aa-e5-8a-a8-e8-8e-b7-e5-be-97-e7-84-a6-e7-82-b9-ef-bc-9f/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在AndroidManifest.xml里的Activity定义里添加进这个属性<br>[code lang=”xml”]android:windowSoftInputMode=&quot;adjustResize|stateHidden&quot;[/code]<br>或者在onCreate 里添加进<br>[code lang=”java”]<br>getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_HIDDEN | WindowManager.LayoutParams.SOFT_INPUT_ADJUST_UNSPECIFIED);[/code]<br>有时候在某些手机上只添加stateHidden也许无效，需要加入下面这段</p>
<p>EditText始终不弹出软件键盘<br>例：EditText edit=(EditText)findViewById(R.id.edit);<br>edit.setInputType(InputType.TYPE_NULL);</p>
<p>让EditText失去焦点，使用EditText的clearFocus方法<br>例如：EditText edit=(EditText)findViewById(R.id.edit);<br>edit.clearFocus();</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://quanke.name/2012/11/10/e8-bd-ac-e4-b8-80-e4-b8-aa-e5-bd-93-e4-ba-86-e7-88-b9-e7-9a-84-e7-a8-8b-e5-ba-8f-e5-91-98-e7-9a-84-e8-87-aa-e7-99-bd/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="全科">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/dog.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="全科-不安分的码农">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2012/11/10/e8-bd-ac-e4-b8-80-e4-b8-aa-e5-bd-93-e4-ba-86-e7-88-b9-e7-9a-84-e7-a8-8b-e5-ba-8f-e5-91-98-e7-9a-84-e8-87-aa-e7-99-bd/" itemprop="url">[转]一个当了爹的程序员的自白</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2012-11-10T05:19:43+08:00">
                2012-11-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/随笔/" itemprop="url" rel="index">
                    <span itemprop="name">随笔</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2012/11/10/e8-bd-ac-e4-b8-80-e4-b8-aa-e5-bd-93-e4-ba-86-e7-88-b9-e7-9a-84-e7-a8-8b-e5-ba-8f-e5-91-98-e7-9a-84-e8-87-aa-e7-99-bd/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2012/11/10/e8-bd-ac-e4-b8-80-e4-b8-aa-e5-bd-93-e4-ba-86-e7-88-b9-e7-9a-84-e7-a8-8b-e5-ba-8f-e5-91-98-e7-9a-84-e8-87-aa-e7-99-bd/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>我喜爱我的工作，我喜爱我的事业，我喜爱解决难题，我喜爱开发漂亮的软件。这些仅仅次于我对我的小女儿的喜爱。<br>　　前几年年轻些时，我是一个到公司最早，编一天的程序，最后一个离开公司的程序员，回到家后上网，继续编程，直到深夜。开发什么并不重要，我只是想编程。然后一件奇妙的事情发生了。我和老婆有了一个孩子。<br>　　当知道珍妮怀孕了后，我欣喜若狂。并不是因为得到这样的一个结果是一个不容易的过程，而是我一直都想要个孩子。我想做一名父亲。不，我想当一名好父亲。我发誓，我向我未出生的孩子发誓，我将会是，最起码，是一个一直在她身边，只属于她的好父亲。<br>　　对于这样的诺言，你可能会想“哪你还去不去工作了？程序员这种以咖啡因做动力、经常加班加点、动不动就最后决战的职业是不允许你以一句‘我要回家和孩子一起吃饭‘就能应付的。”的确是这样。对于我，这是一个”什么更重要”的问题，我有一个简单的理由：如果你把工作搞砸了，你总可以再找另外一个工作，但如果你把家庭关系搞砸了，特别是跟孩子的关系，你永远无法弥补，你会一辈子背负这个债务。<br>　　所以，我的选择是，每天都要在家里花些时间陪我的女儿，即使是这样做对我的事业有负面的影响。我每天早上6：30-6：45到公司，结结实实的工作9小时，下午4点钟左右离开公司回家。从4：30到7：30的时间是专享的，它属于我的女儿。这样做了之后，最难处理的部分是，和我一起工作的很多人是在西海岸的(从时区习惯上，他们比我们会晚几个小时)，很自然，他们经常会把会议时间安排在太平洋标准时间的下午2点或3点。这直接跟我设定的和我的女儿一起玩耍的时间有冲突，所以，我会尽量要求重新安排这样的会议，或直接不参加。当然，我会尽量照顾到工作，如果有事情是非常的重要，我还是会到场的，不论是什么时间。我是非常坚持我的作息安排，原因就是我上面提到过的思想认识。一旦把女儿放上来床，我就可以和妻子一起自由安排余下的时间，有必要的话也会开发点程序。在晚上8点或9点被打电话去和西海岸的团队开会的事情再也没有发生过。<br>　　起初，留下我的兄弟们在公司干活，我却独自回家，这让我内疚很多。尤其是在一次工作互查的过程中有人反馈说，作为一个团队的领导，当团队不得不加班时，领导最好也应该随团队一起加班。但是，如果你看一下我的时间分配，每天超过9小时花在工作上，只有3小时留给我的女儿。如果有人说这不公平，那这最不公平的是对我的女儿。<br>　　这样做了之后，我发现，离开键盘一段时间，反而会增加我的工作效率。我回到家，和女儿玩耍，吃完饭，给她洗澡，给她读童话，抱她上床。所有的这些时间里，我的大脑并没有停止，潜意识里仍在整理分析遇到的问题，思索解决的方案。有大量的科学研究表明，当你想解决一个难题时，停下来休息一下是对你解决这个问题有好处的。加之，有些事情是可以提振你的精神的，比如和一个2岁的孩子玩耍。<br>　　的确，我的代码的产出量不再向以前那样丰硕，一定程度上是因为这些日子里我更多的把时间花在指导上，但同时也是因为我的代码写的更精简、更好了。<br>　　我发现的另外一个好处是，我不再有筋疲力尽的感觉了。赶任务、加班加点给你带来的危害很大。如今，我来到公司，精神饱满、思路清晰，能扎扎实实的工作。但你每天工作20小时的疯狂加班时，实际上只有很少的时间是有效率的(甚至完全没有效率！)疲劳过度后你的大脑是混沌的，除了工作做不好，工作之外的所有事情都会受到影响。更糟糕的是，这种影响还会自我放大。因为你想拼命的完成一个需求不合理或计划评估错误的项目,你必然会弄得精疲力竭，这样又会导致你在下一个计划上完不成任务而加班加点，你进入了一个恶性循环。<br>　　即使你没有像我这样好的理由，你也要严格限制你的加班加点。你甚至会发现，当拿出一些时间花在一些有益的业余爱好上后，你的工作反而会做的更好。如果你对我的建议感兴趣，那就买一本37signals公司的那个家伙写的Rework(重来)这本书。里面有很多这方面的东西。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://quanke.name/2012/11/10/e7-9c-9f-e5-b8-8c-e6-9c-9b-e6-88-91-e7-ac-ac-e4-b8-80-e6-ac-a1-e5-88-9b-e4-b8-9a-e6-97-b6-e5-b0-b1-e7-9f-a5-e9-81-93-e7-9a-84-e4-ba-8b/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="全科">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/dog.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="全科-不安分的码农">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2012/11/10/e7-9c-9f-e5-b8-8c-e6-9c-9b-e6-88-91-e7-ac-ac-e4-b8-80-e6-ac-a1-e5-88-9b-e4-b8-9a-e6-97-b6-e5-b0-b1-e7-9f-a5-e9-81-93-e7-9a-84-e4-ba-8b/" itemprop="url">真希望我第一次创业时就知道的事</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2012-11-10T01:35:41+08:00">
                2012-11-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/随笔/" itemprop="url" rel="index">
                    <span itemprop="name">随笔</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2012/11/10/e7-9c-9f-e5-b8-8c-e6-9c-9b-e6-88-91-e7-ac-ac-e4-b8-80-e6-ac-a1-e5-88-9b-e4-b8-9a-e6-97-b6-e5-b0-b1-e7-9f-a5-e9-81-93-e7-9a-84-e4-ba-8b/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2012/11/10/e7-9c-9f-e5-b8-8c-e6-9c-9b-e6-88-91-e7-ac-ac-e4-b8-80-e6-ac-a1-e5-88-9b-e4-b8-9a-e6-97-b6-e5-b0-b1-e7-9f-a5-e9-81-93-e7-9a-84-e4-ba-8b/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>我们常常事后诸葛亮。当你回头看看之前做过的项目或努力，你总能更好地意识到什么事重要、什么事不重要。</p>
<p>在创业上也是一样的。在一项事业上奋斗了一两年或更多的时间后，你总能更好地意识到一些事是值得担心的，而另一些事其实没什么大不了。</p>
<p>既然创业者是最有资格给其他创业者在如何开始创业上提供建议的，我决定去问25名创业者同一个问题：你希望当年第一次创业时就已经了解的事是什么？而下面是就是这个问题的集合。或许这对刚刚开始创业或正在准备创业的你会有价值：</p>
<p><a href="http://img01.36krcnd.com/wp-content/uploads/2012/11/wish_i_knew_header.jpg" target="_blank" rel="external"><img src="http://img02.36krcnd.com/wp-content/uploads/2012/11/wish_i_knew_header.jpg" alt="" title="wish_i_knew_header"></a></p>
<p>Dan Martell <a href="http://clarity.com/" target="_blank" rel="external">Clarity</a>创始人：</p>
<blockquote>
<p>在开始时，你很可能不知道怎样把事情做对，这其实没什么关系。</p>
<p>直到我真正着手创业时，我才意识到实际上并不需要在一开始就知道该怎么做——你需要的只是学会快速地把正确答案给找出来。如果你能够专注于学习并获取正确的建议——那你将可以接受任何挑战。一旦你意识到这点，你会感到解放。<br>Neil Patel  <a href="http://www.crazyegg.com/" target="_blank" rel="external">Crazy Egg</a>联合创始人：<br>我希望我当时能知道怎么做<strong>定价测试</strong>。当我们第一次发布产品时，我们的定价是基于我们自己想要的定价，而实际上优化价格可以达到最大收入和利润。</p>
<p>我们的顾客群当时要求价格低一些，因为他们的这个需求很旺，我们照做了。尽管这么做增加了整体的注册人数，但我们的整体收入减少了。如果我们能在当时知道定价测试，我们就不会犯这么大的错误。<br>Nick Francis  <a href="http://www.helpscout.net/" target="_blank" rel="external">Help Scout</a>的CEO兼联合创始人：<br>我希望我当时能够知道，获得一名顾客、让他为你的产品买单并且像你所希望的觉得产品很棒是一件很难的事。</p>
<p>大部分的创始人都将获得顾客作为预料中的结局，而实际上要达到所预想的顾客数，最短可能都需要两到三年。这个过程的每个环节对公司来说都是巨大的挑战。不会这么快就实现。</p>
<p>在早期顾客获得上的一些小建议：</p>
<p>1）和目标市场中愿意和你聊的每个人都聊一聊。要比他们自己更了解他们的需求。你最有价值的洞察将会来自每天和顾客的聊天。</p>
<p>2）对潜在顾客进行营销是一系列的实验。在你开始之前，先定义好成功和失败分别是怎样。当实验完成，就可以往复进行了。</p>
<p>3）你周围的团队成员和顾问会追究你的业务度量和财政情况。业务的成功和失败取决于这些人。你需要完全地信任他们，因为你没时间去做监视。<br>Allan Branch ，<a href="http://lessaccounting.com/" target="_blank" rel="external">LessAccounting</a>联合创始人：<br>我和我的商业伙伴Steve Bristol在创业的头一年里花了大量的时间在工作上。我们曾经每周工作80小时以上。这样的工作让我们身心疲惫，也让我们意识到，即使我们花了40 x 2的时间，公司也不会因此增速2倍。事实上，我们那额外的40小时比头40小时的效率要低。而且根本就不会有完成工作的时候，你永远都完不成所有测试，所有的功能，完成完美的设计。最后一次在将近凌晨4点的时候，我们合上了笔记本，回家。永远不要忘记，工作是为了让你的个人生活更有收获的一部分。</p>
<p>而且我也不再关心我会不会变得有名，不去想自己是否会变得极其富有或能上封面杂志。我更在意怎么让我们的顾客和员工感到开心。而在我变得出名时，我唯一担心的人就是我的孩子和妻子。即使现在32岁了，我依旧努力让我的父母为我感到骄傲。但我已经卸下了要将公司做成价值5亿美元公司的负担，我也为我成为这家不知名软件公司的创始人搞到高兴。</p>
<p>其他小建议：</p>
<p><strong>1）只招那些你会希望在个人时间里愿意和他相处的人</strong></p>
<p><strong>2）前十位员工会决定整个公司的基调。</strong></p>
<p><strong>3）不要招那些因为工资而和你一块工作的人</strong><br>Leo Widrich  <a href="http://bufferapp.com/" target="_blank" rel="external">Buffer</a>联合创始人：<br>我最希望自己在创业时就能了解的事，是你周围的人会比你所想象得更能影响你的成功。看看你每天日常工作中和谁一起，和那些实干家一起工作会成就你的事业并且让你有更重要的自我提升，而和空谈家一块只会毁掉你。所以要精挑细选地招人，就像Jim Robn说过的：“你，是你最常待在一起的五个人的平均值。”<br>Renee Warren，<a href="http://www.onboardly.com/" target="_blank" rel="external">Onboardly</a>的联合创始人：<br>我希望我当时可以更好的了解我时间的价值。一场10分钟的聊天常常会变成非常漫长的聊天，而且你很容易就答应去这么做。我花了好几年的时间，才学会拒绝那些会分散我注意力的事。拒绝开会、拒绝采访并且拒绝额外的项目（额外的钱）。当我完成了我每天的任务列表后，我的整天、整周、整个月都变了。在我完成工作之后，我才会接受那些机会。</p>
<p>而这些意识来自我的爷爷，他曾经跟我说“如果你不提早10分钟，你就会迟到10分钟。”他这么说的原因有很多，可能意味着出席会议、赶飞机、打电话、去健身等等。</p>
<p>总而言之，我最希望我在创业时就能了解的事就是：<strong>时间是你最宝贵的一样东西，请确保你的时间投资是明智的。</strong><br>Poornima Vijayashankar ，<a href="http://bizeebee.com/" target="_blank" rel="external">BizeeBee</a>联合创始人兼CEO：<br>我知道开发产品需要时间，但我也希望我在当时就能够知道，让用户接受一个产品也需要时间。尽管你可能会有一些执着使用你产品的早期用户，但主流的接受需要花很长的时间，也需要很多的努力。主流接受需要那些不是早期用户的人们，那些不愿意改变的人，去发现你的产品，理解其中的价值主张，并愿意去尝试它，然后才是真正地使用它并买下它，并最后发展到成为一位愿意和别人谈论它的粉丝。这个周期需要好一段时间，因为它需要一个稳定的产品，让用户可以和你的公司和产品发展关系，并最终在关系够好的情况下愿意和别人谈论。</p>
<p>尽管在营销上的努力可以为周期埋下种子，但为了让主流接受成为可能，大部分时间还是需要花在产品没有上市的时候。只付出不获得的时间过程对于创始人来说是艰难的，因为作为创始人你会希望一切在你的控制之内，并且让计划实现。但<strong>有时候你需要的就是耐心和等待！</strong><br>Ari Tulla ，<a href="http://betterdoctor.com/" target="_blank" rel="external">BetterDoctor</a>联合创始人兼CEO：<br><strong>尽可能快地建立一个公众可用原型，然后再去迭代它。</strong></p>
<p>我们在BetterDoctor上的计划是在两个月内做出第一代最小可行的原型产品（Minimum viable product, <em>MVP</em>）然后将它推向市场。我们把它做出来了，但因为他的可行性不够，我们只好把它放在封闭测试当中。封闭测试意味着非常少的用户以及非常少的真实反馈。</p>
<p>所以到最后，我们花了超过6个月的时间才最终推出了我们第一个beta版产品（依旧是个MVP）。而现在，也就是一年后，我们推出了针对全国的BetterDoctor搜索服务，并且有了一个稳定的平台。现在我们能在几天内推出新功能，并通过真实的用户做立即测试。</p>
<p>要知道，年是个很长的时间单位，如果有什么方法可以尽快让你的产品传到顾客手上，那你就应该去尝试。<br>Andrew Angus ，<a href="http://www.switchvideo.com/" target="_blank" rel="external">Switch Video</a>联合创始人兼CEO：<br>我希望我在当时能够知道这个机会有多大，让我可以更好地计划利用它。现在我的公司老了、更结构化了，这可以让我更好地专注在策略上。如果我可以在一开始的时候就做到往回走一步、发展并投资一个更好的计划，我可能会我避免犯下的一堆错误。不过这些错误也成为了我学习中的一部分，这让我觉得我会继续变得成功（因为我会犯的错少了。）<br>Mike Arsenault ，<a href="http://rejoiner.com/" target="_blank" rel="external">Rejoiner</a>联合创始人：<br>永远不要猜价格。有很多方法可以检测你的产品定价，但很多第一次创业的人们（包括我自己）总是默认为“价格”就是自己所认为的顾客愿意给的价格。另外，把精力放在你为你的顾客所创造的价值上，而不是你提供产品或服务时需要花的成本。</p>
<p>市面上有很多帮你针对目标市场、建立理想价格结构的整体设计方案。这和找出哪个产品功能是顾客认为最有价值的一样重要。</p>
<p>将支付意愿的数据和你顾客最想要的功能结合起来，你就有一个帮你发现定价结构的落地方案，而这个结构会吸引正确的用户并为你的生意带来最多的利润。<br>Ethan Bloch ，<a href="http://techcrunch.com/2011/10/13/marketing-startup-flowtown-gets-swooped-up-by-demandforce/" target="_blank" rel="external">Flowtown</a>联合创始人：<br>不要通过那些没做成过、或没有在你想实现领域上做事的人获取建议。<br>Kapil Kale ，<a href="http://www.giftrocket.com/" target="_blank" rel="external">GiftRocket</a>联合创始人：<br>Idea是很棒的，但同时，在发行之前回头想想产品也是非常重要的。问问自己，谁会用这个产品，他们都是怎么听说到它的？</p>
<p>很多时候，这些问题都会揭示出那些你需要建立在产品当中的关键功能，这些功能会让一位用户因为它很有用而告诉了他的朋友。<br>Bo Lu ，<a href="http://www.futureadvisor.com/" target="_blank" rel="external">FutureAdvisor</a>联合创始人兼CEO：<br><strong>及时回头想想。</strong></p>
<p>第一次创业的人常常会在他们作为创始人的头一段时间内担心一些没必要担心的事。我今天和一些创业者聊天，问到我最多的问题大概是“怎么合法地建一家公司”，“是不是应该辞掉现在的工作还是等等看有没有奖金”。而经验显示，这些事情根本就不会建成或毁掉公司。所以，我希望第一次创业的人可以在他们作为创始人的关键的头几天里想想他们的顾客。了解什么是顾客需要的，做到理解竞争对手并保持优于竞争对手才是会让你建成或毁掉公司的问题。这么做的最好方法就是及时回头想想。假设四年后的今天你已经拥有了一家成功的公司，问问你自己：“那个曾经让我整夜辗转反侧的苦恼问题到现在还是我的问题吗？”这个问题的答案通常是“no”。<br>Dharmesh Shah，<a href="http://hubspot.com/" target="_blank" rel="external">HubSpot</a>的联合创始人兼CTO：<br>选择一个大的、不断增长并且对于你来说是有明显优势的市场是很重要的。还有，要保证自己掌握着自己的命运，而不是过分地依赖其他人。<br>Blake Williams，<a href="http://www.keepsy.com/" target="_blank" rel="external">Keepsy</a>联合创始人：<br>通过让别人看你的计划，寻找出有关你计划的最关键观点。通常来说，新手创业者会爱上一个idea，然后寻求朋友或同事的支持。但毕竟，有谁会希望一个羽翼未丰的想法被反对者扼杀呢？不过，你应该去找的就是这种人。</p>
<p>让他们从头到尾地去毁你的计划和设计。如果你发现自己同意他们的观点并同样存在疑问，那你的计划（或者你）可能就是不能成行的。但如果你可以反复地有信念维护它，那你可能有勇气去克服你将面临的长久、艰难的苦差，这意味着这个计划或许能做得起来。<br>Otto Hilska， <a href="https://www.flowdock.com/" target="_blank" rel="external">Flowdock</a>创始人兼CEO：<br>众所周知，“不成熟的优化是万恶之源”，但我当时没有意识到，在我们花了大量时间和不同的数据库打交道之前，我们会不会有顾客。在开始的时候，你真的可以用一个半生熟的产品去验证你的假设。<br>Rami Essaid ，<a href="http://www.distil.it/" target="_blank" rel="external">Distil</a>联合创始人兼CEO<br>我希望在我第一次创业时就知道的事，是如何设置清楚且可以衡量的目标。任何创业公司都有的问题，就是它们有百万个未知数。当你在建立自己公司的时候，你可以试着尽可能多地回答这些问题。而一旦你回答得够多，你就已经知道你想做些什么。这个方法容易让人迷失。而为了确保你不会迷失，你需要设置清楚的目标并且能够衡量你的行为是否成功。如果你看到有些东西不起作用，那当务之急就是尽快地识别并纠正问题或快速改变方向。目标和指标是这么做的唯一方法。<br>Alex Schiff <a href="http://www.fetchnotes.com/" target="_blank" rel="external">Fetchnotes</a>联合创始人兼CEO：<br>我希望以前有人能教我的事情，就是你应该优化速度而不是成本。创业公司的一切都与速度以及你快速转移的能力有关。我们曾经在获得融资前自力更生过很长的时间，所以我们别无选择地变得超级节俭，但我还是希望我能在之前就了解速度的重要性，因为它会让事情变得不同。如果你花了一个小时的时间去编写程序达到一个月省20块的效果，那它根本就不值得。<br>Jason Traff ，<a href="http://leaky.com/" target="_blank" rel="external">Leaky</a>创始人：<br>从MIT出来，我获得了不少有关创业的好建议，包括了特别保护权的重要性，团队化学反应以及如何做一个好产品。我希望我能在当初了解更多创业生活中的情感变化。通常电影或电视剧里的创业公司，总是一群20多岁的年轻人天天踢足球，夜夜办派对的景象。他们很少在这些高情绪中展示出人们的低落。</p>
<p>我的人生在我开了Leaky后，得到了很多以前从未有过并且频繁激烈的拒绝。在无数的拒绝之后，我学会了：你需要用毅力去看开暂时的情绪高低，并知道没有什么收获或者挫折会是永久性的。否则，这些情绪将无法在第二天早上从床上爬起来。<br>Tri Tran， <a href="http://munchery.com/" target="_blank" rel="external">Munchery</a>联合创始人兼CEO：<br>这当中会有很多的起起落落。当你感到在往下走时，保持平静，要知道事情会变得更好。当你在往上走时，享受那个时刻，但同时也将这种能量存下来应对不好的时候。</p>
<p>我很幸运地在不同的创业公司工作过，知道大概会发生什么。</p>
<p>准备去成立你的第一家创业公司可能是你在人生中做过的最难的事。它并不总会那么迷人。你需要寻求你伴侣的支持，你要有充分信任并能很好协作的联合创始人。但最后，你会想象不到还有什么职业经历会比成立自己的公司更好。<br>Ash Rust ，<a href="http://www.sendhub.com/" target="_blank" rel="external">SendHub</a>联合创始人：<br>专注比你想象得更重要。<br>Gautam Gupta ，<a href="http://www.naturebox.com/" target="_blank" rel="external">NatureBox</a>创始人：<br>创立NatureBox是让我最难忘的经历了。我永远都会为有机会建立它而心存感激。我认为对于创始人来说很重要的，就是要知道成立一家公司的时机。这会带来你情绪上的高叠起伏。管理你的情绪状态会变得很难但很重要。当你触及低谷，记得提醒自己这只是路上的一个颠簸。</p>
<p>你可以放松，将时间花在不该担心的事情上。你会经常受到好消息和坏消息，你还会感到你的生活依赖于你公司的成功，但在这些之后，记得保持你清醒的头脑和执行力。<br>Walter Chen， <a href="http://idonethis.com/" target="_blank" rel="external">iDoneThis</a>联合创始人兼CEO：<br>我希望我当初会知道，运营一个创业团队会很像做父母。你要检查他们，你会想知道他们在干什么，你会担心他们在开车的时候Skype语音。而且你还需要经常大喊：“所有人安静！”而有的时候，你必须提醒他们在晚饭之前完成他们的工作。另外一些时候，你会想让他们娱乐放松，所以你带他们去看电影或去玩卡丁车。</p>
<p>作为一位创业公司创始人，你希望帮助你的团队去认清他们在工作上的强项，并支持他们。你希望他们去犯错并从错误中学习，而不是羞愧地逃避。你不做决定，而是问：“你怎么看？”你要对他们的情绪流动敏感，你要知道他们什么时候是气馁或沮丧的。你自己也会感到沮丧，但你的会将这些情绪更有建设性地表达给他们。毕竟，就像所有父母那样，你希望他们开心，并且成功。因为我就是个家长。<br>Rick Perreault， <a href="http://unbounce.com/" target="_blank" rel="external">Unbounce</a>联合创始人兼CEO：<br>我希望我当初会知道，准确的度量会有多重要，这样我们就可以更容易地对我们的第一次报告做支持。这两年中，我已经听过很多次“因为app的原因，我们不能很好地做跟踪。”如果我们在之前就决定好哪些关键度量是需要跟踪的，并根据需要做app，我们可能就不用那么痛苦了。<br>Elizabeth Yin ：<br>我成立的第一家公司是一个社交购物应用，那基本上就是个灾难。我们将我们所认为的优秀工具给做了出来，但却没人想用。我们花了大概2万美元并且用了将近一年半的时间。通过这个经验，我意识到最难的部分不是技术，而是知道用户需求。</p>
<p>如果我当时能够换种方式做，我就会在把产品做出来之前先用小样测试市场，我就会创建登录页面捕捉潜在用户的联系方式并已经和他们在谈了。我就会做个假按钮来衡量需求。简单来说，我希望我在当初就能够在做产品之前先测试一下市场。<br>原文来自： <a href="http://davidhauser.com/post/35203066523/advice-from-21-entrepreneurs" target="_blank" rel="external">DavidHauser</a> 创业者David Hauser的个人博客</p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://quanke.name/2012/11/08/android/android-e8-af-ad-e9-9f-b3-e5-bd-95-e5-88-b6-e5-92-8c-e5-8e-8b-e7-bc-a9/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="全科">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/dog.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="全科-不安分的码农">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2012/11/08/android/android-e8-af-ad-e9-9f-b3-e5-bd-95-e5-88-b6-e5-92-8c-e5-8e-8b-e7-bc-a9/" itemprop="url">android语音录制和压缩</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2012-11-08T04:16:09+08:00">
                2012-11-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/android开发/" itemprop="url" rel="index">
                    <span itemprop="name">android开发</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2012/11/08/android/android-e8-af-ad-e9-9f-b3-e5-bd-95-e5-88-b6-e5-92-8c-e5-8e-8b-e7-bc-a9/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2012/11/08/android/android-e8-af-ad-e9-9f-b3-e5-bd-95-e5-88-b6-e5-92-8c-e5-8e-8b-e7-bc-a9/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>因为上一篇博客代码有点太多，就单开了，这两天主要在看android语音录制和压缩转码相关知识，前段时间看见腾讯官方微博宣布，已经开放出即使聊天软件正在等待审批，但这个直接影响电话运营商，能通过的可能性应该不大，但我对这方面的技术很有兴趣，所以就试试看。其中涉及到很多声音方面的处理问题，在android中有两个类可以录制语音：AudioRecord和MediaRecorder，MediaRecorder主要是录制音频并写入文件，而AudioRecord主要是录制音频流，录制的音频流为pcm格式，关于pcm格式可以自行搜索一下，在传输过程中可以转换为amr格式，但没有相关可以类库有点麻烦，另外iphone不支持播放amr格式音频，如果需要跨两个平台可以使用AAC，压缩比也不错，音质也很好，我还没有测试过，网上评议而已。编码方面大家都推荐speex，我看了一下，需要是用System.loadLibrary加载进speex提供的类库。下面记录一下写的一个边录制边播放的一段代码吧</p>
<p>[code lang=”java”]</p>
<p>import java.io.IOException;</p>
<p>import android.app.Activity;<br>import android.os.Bundle;<br>import android.os.Looper;<br>import android.os.Process;<br>import android.util.Log;<br>import android.view.MotionEvent;<br>import android.view.View;<br>import android.widget.Button;<br>import android.widget.Toast;</p>
<p>import android.media.AudioFormat;<br>import android.media.AudioManager;<br>import android.media.AudioRecord;<br>import android.media.AudioTrack;<br>import android.media.MediaRecorder;</p>
<p>public class VoiceHcentActivity extends Activity {</p>
<pre><code>static {
    System.loadLibrary(&amp;quot;media_jni&amp;quot;);
}

public int frequency = 8000;
private int rBufferSize, pBufferSize;
private Button startSpeech;
private AudioRecord recorder;
private VoiceSpeech vspeech;
private AudioTrack player;
private boolean stopSpeech = false;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    init();

    test();
}

public void init(){
    try{
        startSpeech = (Button)findViewById(R.id.StartSpeech);

        //设置播放器缓冲区大小
        pBufferSize = AudioTrack.getMinBufferSize(frequency, AudioFormat.CHANNEL_CONFIGURATION_MONO,
                AudioFormat.ENCODING_PCM_16BIT);

        //获取播放器对象
        player = new AudioTrack(AudioManager.STREAM_MUSIC, frequency,
                AudioFormat.CHANNEL_CONFIGURATION_MONO, AudioFormat.ENCODING_PCM_16BIT,
                pBufferSize, AudioTrack.MODE_STREAM);

        //设置录音缓冲区大小
        rBufferSize = AudioRecord.getMinBufferSize(frequency,
                AudioFormat.CHANNEL_CONFIGURATION_MONO, AudioFormat.ENCODING_PCM_16BIT);

        //获取录音机对象
        recorder = new AudioRecord(MediaRecorder.AudioSource.MIC,
                frequency, AudioFormat.CHANNEL_CONFIGURATION_MONO,
                AudioFormat.ENCODING_PCM_16BIT, rBufferSize);

    }catch (Exception e) {
        String msg = &amp;quot;ERROR init: &amp;quot;+e.getStackTrace();
        VoiceHcentActivity.this.toastMsg(msg);
    }
}

/**
 * 开始录音
 */
public void startRecord(){
    stopSpeech = false;
    vspeech = new VoiceSpeech();
    vspeech.start();
}

/**
 * 结束录音
 */
public void stopRecord() {
    stopSpeech = true;
}

/**
 * 开始播放录音
 */
public void startPlay(){

    //设置播放器音量
    player.setStereoVolume(0.7f, 0.7f);

    player.play();
}

/**
 * 结束播放录音
 */
public void stopPlay(){
    player.stop();
}

public void test(){

    startSpeech.setOnTouchListener(new View.OnTouchListener() {

        public boolean onTouch(View arg0, MotionEvent arg1) {

            switch (arg1.getAction()) {

                case MotionEvent.ACTION_DOWN: //开始说话
                    startPlay();
                    startRecord();

                    toastMsg(&amp;quot;starting record!&amp;quot;);
                    break;

                case MotionEvent.ACTION_UP: //停止说话
                    Log.i(&amp;quot;hcent&amp;quot;, &amp;quot;111&amp;quot;);
                    stopPlay();
                    Log.i(&amp;quot;hcent&amp;quot;, &amp;quot;222&amp;quot;);
                    stopRecord();
                    toastMsg(&amp;quot;stoped record!&amp;quot;);
                    break;

                default:
                    break;
            }

            return false;
        }
    });

}

public class VoiceSpeech extends Thread{

    @Override
    public void run() {
        super.run();
        try {
            byte[] tempBuffer, readBuffer = new byte[rBufferSize];
            int bufResult = 0;
            recorder.startRecording();
            while(!stopSpeech){
                bufResult = recorder.read(readBuffer, 0, rBufferSize);
                if(bufResult&amp;gt;0 &amp;amp;&amp;amp; bufResult%2==0){
                    tempBuffer = new byte[bufResult];
                    System.arraycopy(readBuffer, 0, tempBuffer, 0, rBufferSize);
                    player.write(tempBuffer, 0, tempBuffer.length);
                }
                Log.d(&amp;quot;hcent&amp;quot;, &amp;quot;get read:&amp;quot;+bufResult+&amp;quot;___&amp;quot;+readBuffer.length);
            }
            recorder.stop();
            Looper.prepare();
            VoiceHcentActivity.this.toastMsg(&amp;quot;AudioSpeech have ended!&amp;quot;);
            Looper.loop();
        } catch (Exception e) {
            String msg = &amp;quot;ERROR AudioRecord: &amp;quot;+e.getStackTrace();
            Looper.prepare();
            VoiceHcentActivity.this.toastMsg(msg);
            Looper.loop();
        }
    }
}
@Override
protected void onDestroy(){
    player.release();
    recorder.release();
    super.onDestroy();
    Process.killProcess(Process.myPid());
}
public void toastMsg(String msg){
    Toast.makeText(this, msg, Toast.LENGTH_SHORT).show();
    Log.e(&amp;quot;hcent&amp;quot;, msg);
}
</code></pre><p>}<br>[/code] </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://quanke.name/2012/11/08/e9-9f-b3-e9-a2-91-e5-8e-8b-e7-bc-a9-e5-b7-a5-e5-85-b7-e2-80-94-e2-80-94speex-e7-9a-84-e4-bd-bf-e7-94-a8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="全科">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/dog.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="全科-不安分的码农">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2012/11/08/e9-9f-b3-e9-a2-91-e5-8e-8b-e7-bc-a9-e5-b7-a5-e5-85-b7-e2-80-94-e2-80-94speex-e7-9a-84-e4-bd-bf-e7-94-a8/" itemprop="url">音频压缩工具——Speex的使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2012-11-08T04:13:24+08:00">
                2012-11-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/android开发/" itemprop="url" rel="index">
                    <span itemprop="name">android开发</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2012/11/08/e9-9f-b3-e9-a2-91-e5-8e-8b-e7-bc-a9-e5-b7-a5-e5-85-b7-e2-80-94-e2-80-94speex-e7-9a-84-e4-bd-bf-e7-94-a8/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2012/11/08/e9-9f-b3-e9-a2-91-e5-8e-8b-e7-bc-a9-e5-b7-a5-e5-85-b7-e2-80-94-e2-80-94speex-e7-9a-84-e4-bd-bf-e7-94-a8/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在Android开发中，需要录音并发送到对方设备上。这时问题来了，手机常会是GPRS、3G等方式上网，所以节省流量是非常关键的，使用Speex来压缩音频文件，可以将音频压文件小数倍。</p>
<p>1.去Speex官网下载最新Speex源码。</p>
<p>2.创建一个新的应用（我创建的应用名为Audio），并创建一个jni目录（$project/jni）。</p>
<p>3.把speex源码目录下的libspeex和include目录及其子目录文件全部拷贝到$project/jni目录下</p>
<p>[code lang=”java”]（$project/jni/libspeex and $project/jni/include）。<br>[/code]</p>
<p>4.在jni目录下新增Android.mk文件，编辑内容如下</p>
<p>[code lang=”java”]LOCAL_PATH := $(call my-dir)</p>
<p>include $(CLEAR_VARS)<br>&amp;nbsp;<br>LOCAL_MODULE &amp;nbsp; &amp;nbsp;:= libspeex<br>LOCAL_CFLAGS = -DFIXED_POINT -DUSE_KISS_FFT -DEXPORT=&quot;&quot; -UHAVE_CONFIG_H<br>LOCAL_C_INCLUDES := $(LOCAL_PATH)/include<br>&amp;nbsp;<br>LOCAL_SRC_FILES := &amp;nbsp;\<br>./speex_jni.cpp \<br>./libspeex/bits.c \<br>./libspeex/buffer.c \<br>./libspeex/cb_search.c \<br>./libspeex/exc_10_16_table.c \<br>./libspeex/exc_10_32_table.c \<br>./libspeex/exc_20_32_table.c \<br>./libspeex/exc_5_256_table.c \<br>./libspeex/exc_5_64_table.c \<br>./libspeex/exc_8_128_table.c \<br>./libspeex/fftwrap.c \<br>./libspeex/filterbank.c \<br>./libspeex/filters.c \<br>./libspeex/gain_table.c \<br>./libspeex/gain_table_lbr.c \<br>./libspeex/hexc_10_32_table.c \<br>./libspeex/hexc_table.c \<br>./libspeex/high_lsp_tables.c \<br>./libspeex/jitter.c \<br>./libspeex/kiss_fft.c \<br>./libspeex/kiss_fftr.c \<br>./libspeex/lpc.c \<br>./libspeex/lsp.c \<br>./libspeex/lsp_tables_nb.c \<br>./libspeex/ltp.c \<br>./libspeex/mdf.c \<br>./libspeex/modes.c \<br>./libspeex/modes_wb.c \<br>./libspeex/nb_celp.c \<br>./libspeex/preprocess.c \<br>./libspeex/quant_lsp.c \<br>./libspeex/resample.c \<br>./libspeex/sb_celp.c \<br>./libspeex/scal.c \<br>./libspeex/smallft.c \<br>./libspeex/speex.c \<br>./libspeex/speex_callbacks.c \<br>./libspeex/speex_header.c \<br>./libspeex/stereo.c \<br>./libspeex/vbr.c \<br>./libspeex/vq.c \<br>./libspeex/window.c<br>&amp;nbsp;<br>include $(BUILD_SHARED_LIBRARY)<br>[/code]</p>
<p>5.在jni目录下新增Application.mk文件，编辑内容如下</p>
<p>[code lang=”java”]<br>APP_ABI := armeabi armeabi-v7a<br>[/code]</p>
<p>6.在$project/jni/include/speex/目录下新增speex_config_types.h文件，编辑内容如下</p>
<p>[code lang=”java”]</p>
<p>#ifndef <strong>SPEEX_TYPES_H</strong></p>
<p>#define <strong>SPEEX_TYPES_H</strong><br>typedef short spx_int16_t;<br>typedef unsigned short spx_uint16_t;<br>typedef int spx_int32_t;<br>typedef unsigned int spx_uint32_t;</p>
<p>#endif<br>[/code]</p>
<p>7.创建JNI包装类speex_jni.cpp，用来调用Speex中的C代码函数，编辑内容如下</p>
<p>[code lang=”c”]#include &lt;jni.h&gt;</p>
<p>#include &lt;string.h&gt;</p>
<p>#include &lt;unistd.h&gt;</p>
<p>#include &lt;speex/speex.h&gt;</p>
<p>static int codec_open = 0;</p>
<p>static int dec_frame_size;<br>static int enc_frame_size;</p>
<p>static SpeexBits ebits, dbits;<br>void <em>enc_state;<br>void </em>dec_state;</p>
<p>static JavaVM *gJavaVM;</p>
<p>extern &quot;C&quot;<br>JNIEXPORT jint JNICALL Java_com_audio_Speex_open<br>  (JNIEnv *env, jobject obj, jint compression) {<br>    int tmp;</p>
<pre><code>if (codec_open++ != 0)
    return (jint)0;

speex_bits_init(&amp;amp;ebits);
speex_bits_init(&amp;amp;dbits);

enc_state = speex_encoder_init(&amp;amp;speex_nb_mode);
dec_state = speex_decoder_init(&amp;amp;speex_nb_mode);
tmp = compression;
speex_encoder_ctl(enc_state, SPEEX_SET_QUALITY, &amp;amp;tmp);
speex_encoder_ctl(enc_state, SPEEX_GET_FRAME_SIZE, &amp;amp;enc_frame_size);
speex_decoder_ctl(dec_state, SPEEX_GET_FRAME_SIZE, &amp;amp;dec_frame_size);

return (jint)0;
</code></pre><p>}</p>
<p>extern &quot;C&quot;<br>JNIEXPORT jint Java_com_audio_Speex_encode<br>    (JNIEnv *env, jobject obj, jshortArray lin, jint offset, jbyteArray encoded, jint size) {</p>
<pre><code>    jshort buffer[enc_frame_size];
    jbyte output_buffer[enc_frame_size];
int nsamples = (size-1)/enc_frame_size + 1;
int i, tot_bytes = 0;

if (!codec_open)
    return 0;

speex_bits_reset(&amp;amp;ebits);

for (i = 0; i &amp;lt; nsamples; i++) {
    env-&amp;gt;GetShortArrayRegion(lin, offset + i*enc_frame_size, enc_frame_size, buffer);
    speex_encode_int(enc_state, buffer, &amp;amp;ebits);
}
//env-&amp;gt;GetShortArrayRegion(lin, offset, enc_frame_size, buffer);
//speex_encode_int(enc_state, buffer, &amp;amp;ebits);

tot_bytes = speex_bits_write(&amp;amp;ebits, (char *)output_buffer,
                 enc_frame_size);
env-&amp;gt;SetByteArrayRegion(encoded, 0, tot_bytes,
            output_buffer);

    return (jint)tot_bytes;
</code></pre><p>}</p>
<p>extern &quot;C&quot;<br>JNIEXPORT jint JNICALL Java_com_audio_Speex_decode<br>    (JNIEnv *env, jobject obj, jbyteArray encoded, jshortArray lin, jint size) {</p>
<pre><code>    jbyte buffer[dec_frame_size];
    jshort output_buffer[dec_frame_size];
    jsize encoded_length = size;

if (!codec_open)
    return 0;

env-&amp;gt;GetByteArrayRegion(encoded, 0, encoded_length, buffer);
speex_bits_read_from(&amp;amp;dbits, (char *)buffer, encoded_length);
speex_decode_int(dec_state, &amp;amp;dbits, output_buffer);
env-&amp;gt;SetShortArrayRegion(lin, 0, dec_frame_size,
             output_buffer);

return (jint)dec_frame_size;
</code></pre><p>}</p>
<p>extern &quot;C&quot;<br>JNIEXPORT jint JNICALL Java_com_audio_getFrameSize<br>    (JNIEnv *env, jobject obj) {</p>
<pre><code>if (!codec_open)
    return 0;
return (jint)enc_frame_size;
</code></pre><p>}</p>
<p>extern &quot;C&quot;<br>JNIEXPORT void JNICALL Java_com_audio_Speex_close<br>    (JNIEnv *env, jobject obj) {</p>
<pre><code>if (--codec_open != 0)
    return;

speex_bits_destroy(&amp;amp;ebits);
speex_bits_destroy(&amp;amp;dbits);
speex_decoder_destroy(dec_state);
speex_encoder_destroy(enc_state);
</code></pre><p>}<br>[/code]</p>
<p>8.在Java层创建Speex工具类，内容如下</p>
<p>[code lang=”java”]package com.audio;</p>
<p>class Speex  {</p>
<pre><code>/* quality
 * 1 : 4kbps (very noticeable artifacts, usually intelligible)
 * 2 : 6kbps (very noticeable artifacts, good intelligibility)
 * 4 : 8kbps (noticeable artifacts sometimes)
 * 6 : 11kpbs (artifacts usually only noticeable with headphones)
 * 8 : 15kbps (artifacts not usually noticeable)
 */
private static final int DEFAULT_COMPRESSION = 8;

Speex() {
}

public void init() {
    load();    
    open(DEFAULT_COMPRESSION);
}

private void load() {
    try {
        System.loadLibrary(&amp;quot;speex&amp;quot;);
    } catch (Throwable e) {
        e.printStackTrace();
    }

}

public native int open(int compression);
public native int getFrameSize();
public native int decode(byte encoded[], short lin[], int size);
public native int encode(short lin[], int offset, byte encoded[], int size);
public native void close();
</code></pre><p>}<br>[/code]</p>
<p>9.打开cygwin工具，切换到项目目录（我项目是在F:\workspace\Audio），输入$NDK/ndk-build</p>
<p>cygwin工具的安装与配置，可以看这篇文章——<a href="http://blog.csdn.net/chenfeng0104/article/details/7090850" target="_blank" rel="external">使用NDK与环境搭建</a></p>
<p><img src="http://hi.csdn.net/attachment/201112/20/0_1324370946pF9v.gif" alt=""></p>
<p><img src="http://hi.csdn.net/attachment/201112/20/0_1324370960cCla.gif" alt=""></p>
<p>会在项目中生成libs目录和libspeex.so文件，这就是Speex类中System.loadLibrary(“speex”);代码引用的，系统会根据操作系统由”speex”找到对应的动态库libspeex.so，Windows下是.dll文件，linux下是.so文件。</p>
<p>当前，我的项目结构如下图</p>
<p><img src="http://hi.csdn.net/attachment/201112/20/0_1324371398RYMW.gif" alt=""></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/6/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><span class="page-number current">7</span><a class="page-number" href="/page/8/">8</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><a class="extend next" rel="next" href="/page/8/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/dog.jpg"
                alt="全科" />
            
              <p class="site-author-name" itemprop="name">全科</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">115</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">17</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">38</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/quanke" target="_blank" title="GitHub">
                    
                      <i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">全科</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"quanke"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  















<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="//unpkg.com/valine/dist/Valine.min.js"></script>



  





  

  

  

  
  

  

  

  

</body>
</html>
